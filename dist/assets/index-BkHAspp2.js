import{r as f,j as e,a5 as M,aj as ie,a8 as y,a4 as D,a9 as S,a7 as R,ad as H,ac as Q,K as ce,E as U,a3 as de,A as le,F as ue,G as E,a as F,ak as he,z as pe,N as fe,al as me,B as be,I as xe}from"./index-CDJ7DgKs.js";import{a as ge,b as ve,c as ke}from"./card-DinPMtRP.js";import{C as $,b as O,f as I,c as Ce,d as je,e as q,u as we,a as ye,F as P,g as A,h as T,i as Se}from"./field-B7Wg_fYW.js";import"./password-input-DfsXY_sW.js";import"./context-DX6TRtil.js";import{A as _e}from"./app-card-header-with-back-button-yClb5ETe.js";var _="Checkbox",[Ne]=M(_),[Ee,z]=Ne(_);function Pe(t){const{__scopeCheckbox:r,checked:s,children:o,defaultChecked:n,disabled:a,form:u,name:l,onCheckedChange:i,required:b,value:h="on",internal_do_not_use_render:c}=t,[p,g]=D({prop:s,defaultProp:n??!1,onChange:i,caller:_}),[d,v]=f.useState(null),[k,m]=f.useState(null),x=f.useRef(!1),C=d?!!u||!!d.closest("form"):!0,w={checked:p,disabled:a,setChecked:g,control:d,setControl:v,name:l,form:u,value:h,hasConsumerStoppedPropagationRef:x,required:b,defaultChecked:j(n)?!1:n,isFormControl:C,bubbleInput:k,setBubbleInput:m};return e.jsx(Ee,{scope:r,...w,children:Re(c)?c(w):o})}var G="CheckboxTrigger",K=f.forwardRef(({__scopeCheckbox:t,onKeyDown:r,onClick:s,...o},n)=>{const{control:a,value:u,disabled:l,checked:i,required:b,setControl:h,setChecked:c,hasConsumerStoppedPropagationRef:p,isFormControl:g,bubbleInput:d}=z(G,t),v=S(n,h),k=f.useRef(i);return f.useEffect(()=>{const m=a?.form;if(m){const x=()=>c(k.current);return m.addEventListener("reset",x),()=>m.removeEventListener("reset",x)}},[a,c]),e.jsx(y.button,{type:"button",role:"checkbox","aria-checked":j(i)?"mixed":i,"aria-required":b,"data-state":Y(i),"data-disabled":l?"":void 0,disabled:l,value:u,...o,ref:v,onKeyDown:R(r,m=>{m.key==="Enter"&&m.preventDefault()}),onClick:R(s,m=>{c(x=>j(x)?!0:!x),d&&g&&(p.current=m.isPropagationStopped(),p.current||m.stopPropagation())})})});K.displayName=G;var Z=f.forwardRef((t,r)=>{const{__scopeCheckbox:s,name:o,checked:n,defaultChecked:a,required:u,disabled:l,value:i,onCheckedChange:b,form:h,...c}=t;return e.jsx(Pe,{__scopeCheckbox:s,checked:n,defaultChecked:a,disabled:l,required:u,onCheckedChange:b,name:o,form:h,value:i,internal_do_not_use_render:({isFormControl:p})=>e.jsxs(e.Fragment,{children:[e.jsx(K,{...c,ref:r,__scopeCheckbox:s}),p&&e.jsx(J,{__scopeCheckbox:s})]})})});Z.displayName=_;var X="CheckboxIndicator",W=f.forwardRef((t,r)=>{const{__scopeCheckbox:s,forceMount:o,...n}=t,a=z(X,s);return e.jsx(ie,{present:o||j(a.checked)||a.checked===!0,children:e.jsx(y.span,{"data-state":Y(a.checked),"data-disabled":a.disabled?"":void 0,...n,ref:r,style:{pointerEvents:"none",...t.style}})})});W.displayName=X;var V="CheckboxBubbleInput",J=f.forwardRef(({__scopeCheckbox:t,...r},s)=>{const{control:o,hasConsumerStoppedPropagationRef:n,checked:a,defaultChecked:u,required:l,disabled:i,name:b,value:h,form:c,bubbleInput:p,setBubbleInput:g}=z(V,t),d=S(s,g),v=H(a),k=Q(o);f.useEffect(()=>{const x=p;if(!x)return;const C=window.HTMLInputElement.prototype,B=Object.getOwnPropertyDescriptor(C,"checked").set,ne=!n.current;if(v!==a&&B){const oe=new Event("click",{bubbles:ne});x.indeterminate=j(a),B.call(x,j(a)?!1:a),x.dispatchEvent(oe)}},[p,v,a,n]);const m=f.useRef(j(a)?!1:a);return e.jsx(y.input,{type:"checkbox","aria-hidden":!0,defaultChecked:u??m.current,required:l,disabled:i,name:b,value:h,form:c,...r,tabIndex:-1,ref:d,style:{...r.style,...k,position:"absolute",pointerEvents:"none",opacity:0,margin:0,transform:"translateX(-100%)"}})});J.displayName=V;function Re(t){return typeof t=="function"}function j(t){return t==="indeterminate"}function Y(t){return j(t)?"indeterminate":t?"checked":"unchecked"}var N="Switch",[Fe]=M(N),[Ie,qe]=Fe(N),ee=f.forwardRef((t,r)=>{const{__scopeSwitch:s,name:o,checked:n,defaultChecked:a,required:u,disabled:l,value:i="on",onCheckedChange:b,form:h,...c}=t,[p,g]=f.useState(null),d=S(r,C=>g(C)),v=f.useRef(!1),k=p?h||!!p.closest("form"):!0,[m,x]=D({prop:n,defaultProp:a??!1,onChange:b,caller:N});return e.jsxs(Ie,{scope:s,checked:m,disabled:l,children:[e.jsx(y.button,{type:"button",role:"switch","aria-checked":m,"aria-required":u,"data-state":re(m),"data-disabled":l?"":void 0,disabled:l,value:i,...c,ref:d,onClick:R(t.onClick,C=>{x(w=>!w),k&&(v.current=C.isPropagationStopped(),v.current||C.stopPropagation())})}),k&&e.jsx(ae,{control:p,bubbles:!v.current,name:o,value:i,checked:m,required:u,disabled:l,form:h,style:{transform:"translateX(-100%)"}})]})});ee.displayName=N;var te="SwitchThumb",se=f.forwardRef((t,r)=>{const{__scopeSwitch:s,...o}=t,n=qe(te,s);return e.jsx(y.span,{"data-state":re(n.checked),"data-disabled":n.disabled?"":void 0,...o,ref:r})});se.displayName=te;var ze="SwitchBubbleInput",ae=f.forwardRef(({__scopeSwitch:t,control:r,checked:s,bubbles:o=!0,...n},a)=>{const u=f.useRef(null),l=S(u,a),i=H(s),b=Q(r);return f.useEffect(()=>{const h=u.current;if(!h)return;const c=window.HTMLInputElement.prototype,g=Object.getOwnPropertyDescriptor(c,"checked").set;if(i!==s&&g){const d=new Event("click",{bubbles:o});g.call(h,s),h.dispatchEvent(d)}},[i,s,o]),e.jsx("input",{type:"checkbox","aria-hidden":!0,defaultChecked:s,...n,tabIndex:-1,ref:l,style:{...n.style,...b,position:"absolute",pointerEvents:"none",opacity:0,margin:0}})});ae.displayName=ze;function re(t){return t?"checked":"unchecked"}var Be=ee,Ae=se;const Te=t=>ce({queryKey:["quiz-settings",t],queryFn:async()=>(await U.get(`/quizzes/${t}/settings`)).data?.data,enabled:!!t}),Le=t=>{const r=de();return le({mutationKey:["update-quiz-settings",t],mutationFn:async s=>(await U.post(`/quizzes/${t}/settings`,s)).data,onSuccess:()=>{E.success("Settings updated successfully!"),r.invalidateQueries({queryKey:["quiz-settings",t]})},onError:s=>{const o="Failed to update settings.";ue(s)?E.error(s.response?.data?.message||s.message||o):E.error(o)}})};function Me({className:t,...r}){return e.jsx(Z,{"data-slot":"checkbox",className:F("peer flex size-4 shrink-0 items-center justify-center rounded-[4px] border border-input shadow-xs transition-shadow outline-none focus-visible:border-ring focus-visible:ring-[3px] focus-visible:ring-ring/50 disabled:cursor-not-allowed disabled:opacity-50 aria-invalid:border-destructive aria-invalid:ring-destructive/20 data-[state=checked]:border-primary data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground dark:aria-invalid:ring-destructive/40",t),...r,children:e.jsx(W,{"data-slot":"checkbox-indicator",className:"grid place-content-center text-current",children:r.checked==="indeterminate"?e.jsx("svg",{width:"9",height:"9",viewBox:"0 0 9 9",fill:"currentcolor",xmlns:"http://www.w3.org/2000/svg",children:e.jsx("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M0.75 4.5C0.75 4.08579 1.08579 3.75 1.5 3.75H7.5C7.91421 3.75 8.25 4.08579 8.25 4.5C8.25 4.91421 7.91421 5.25 7.5 5.25H1.5C1.08579 5.25 0.75 4.91421 0.75 4.5Z"})}):e.jsx("svg",{width:"9",height:"9",viewBox:"0 0 9 9",fill:"currentcolor",xmlns:"http://www.w3.org/2000/svg",children:e.jsx("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M8.53547 0.62293C8.88226 0.849446 8.97976 1.3142 8.75325 1.66099L4.5083 8.1599C4.38833 8.34356 4.19397 8.4655 3.9764 8.49358C3.75883 8.52167 3.53987 8.45309 3.3772 8.30591L0.616113 5.80777C0.308959 5.52987 0.285246 5.05559 0.563148 4.74844C0.84105 4.44128 1.31533 4.41757 1.62249 4.69547L3.73256 6.60459L7.49741 0.840706C7.72393 0.493916 8.18868 0.396414 8.53547 0.62293Z"})})})})}const L=({name:t,control:r,label:s="",description:o="",disabled:n=!1})=>e.jsx($,{control:r,name:t,render:({field:a,fieldState:u})=>{const{value:l,onChange:i,onBlur:b,name:h}=a,{invalid:c,error:p}=u;return e.jsxs(O,{"data-invalid":c,orientation:"horizontal",className:"w-fit",children:[e.jsx(Me,{id:h,checked:l,onCheckedChange:i,onBlur:b,"aria-invalid":c,disabled:n}),e.jsxs(I,{children:[!!s&&e.jsx(Ce,{htmlFor:h,className:"cursor-pointer whitespace-nowrap",children:s}),!!o&&!c&&e.jsx(je,{children:o}),c&&e.jsx(q,{errors:[p]})]})]})}});function De({className:t,...r}){return e.jsx(Be,{"data-slot":"switch",className:F("peer data-[state=checked]:bg-primary data-[state=unchecked]:bg-input focus-visible:border-ring focus-visible:ring-ring/50 dark:data-[state=unchecked]:bg-input/80 inline-flex h-[1.15rem] w-8 shrink-0 items-center rounded-full border border-transparent shadow-xs transition-all outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50",t),...r,children:e.jsx(Ae,{"data-slot":"switch-thumb",className:F("bg-background dark:data-[state=unchecked]:bg-foreground dark:data-[state=checked]:bg-primary-foreground pointer-events-none block size-4 rounded-full ring-0 transition-transform data-[state=checked]:translate-x-[calc(100%-2px)] data-[state=unchecked]:translate-x-0")})})}const He=({name:t,control:r,disabled:s=!1})=>e.jsx($,{control:r,name:t,render:({field:o,fieldState:n})=>{const{value:a,onChange:u,name:l}=o,{invalid:i}=n;return e.jsx(O,{"data-invalid":i,orientation:"horizontal",className:"w-fit",children:e.jsx(De,{id:l,checked:a,onCheckedChange:u,disabled:s,"aria-invalid":i})})}}),Qe={quiz_id:void 0,lead_form:{email:{enabled:!1,required:!1},phone:{enabled:!1,required:!1},address:{enabled:!1,required:!1},zip:{enabled:!1,required:!1}},result_delivery:{email:!1,pdf:!1,link:!1}};function Xe(){const{id:t}=he.useParams(),r=pe(),s=[{name:"email",label:"Email"},{name:"phone",label:"Phone"},{name:"address",label:"Address"},{name:"zip",label:"Zip Code"}],o=[{name:"email",label:"Email"},{name:"pdf",label:"PDF"},{name:"link",label:"Link"}],{data:n,isLoading:a}=fe(Te(t)),{mutate:u,isPending:l}=Le(t),i=we({resolver:ye(me),defaultValues:n||Qe}),{control:b,handleSubmit:h,formState:{errors:c},reset:p}=i;console.log("ðŸ‘‰ ~ QuizSettingsPage ~ errors:",c);const g=d=>{u(d,{onSuccess:()=>{r({to:"/",search:xe})}})};return f.useEffect(()=>{n&&p(n)},[n,p]),e.jsxs("div",{className:"flex-1 flex flex-col gap-6 overflow-hidden",children:[e.jsx(ge,{className:"flex items-start gap-2",children:e.jsx(_e,{title:"Quiz Settings",description:"Configure lead generation and result delivery for this quiz."})}),a?e.jsx("div",{className:"flex items-center justify-center p-12",children:e.jsx("p",{className:"text-muted-foreground",children:"Loading settings..."})}):e.jsxs(ve,{className:"flex-1 flex flex-col overflow-hidden",children:[e.jsx("form",{onSubmit:h(g),className:"space-y-8 flex-1 overflow-y-auto",children:e.jsxs(P,{children:[e.jsxs(A,{children:[e.jsxs(I,{children:[e.jsx(T,{children:"Lead Form"}),e.jsx(q,{errors:[c.lead_form]})]}),e.jsx(P,{"data-slot":"checkbox-group",children:s.map(d=>e.jsxs("div",{className:"flex items-center gap-2 justify-between max-w-xs",children:[e.jsx(L,{control:b,name:`lead_form.${d.name}.enabled`,label:d.label}),e.jsx(He,{control:b,name:`lead_form.${d.name}.required`,label:"Required"})]},d.name))})]}),e.jsx(Se,{}),e.jsxs(A,{children:[e.jsxs(I,{children:[e.jsx(T,{children:"Result Delivery"}),e.jsx(q,{errors:[c.result_delivery]})]}),e.jsx(P,{"data-slot":"checkbox-group",children:o.map(d=>e.jsx("div",{children:e.jsx(L,{control:b,name:`result_delivery.${d.name}`,label:d.label})},d.name))})]})]})}),e.jsx(ke,{className:"pt-4 w-full flex justify-end items-center gap-2",children:e.jsx(be,{type:"button",className:"min-w-36",onClick:h(g),loading:l,children:"Save Settings"})})]})]})}export{Xe as component};
