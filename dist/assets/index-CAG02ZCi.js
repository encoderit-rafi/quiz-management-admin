import{r as f,j as e,Y as M,aa as ie,$ as y,X as D,a0 as S,_ as P,a4 as H,a3 as Q,z as ce,t as $,W as de,q as le,v as ue,w as N,a as F,ab as he,p as pe,E as fe,ac as me,B as be}from"./index-C0O9Q7MJ.js";import{a as xe,c as ge,d as ve}from"./card-DH7LzJZY.js";import{C as U,b as O,f as q,c as ke,d as Ce,e as z,u as je,a as we,F as R,g as L,h as T,i as ye}from"./field-wCSYO7Ng.js";import"./password-input-BRREzLrV.js";import"./context-CBWJO7S0.js";import{A as Se}from"./app-card-header-with-back-button-NAfeAEHl.js";var _="Checkbox",[_e]=M(_),[Ee,I]=_e(_);function Ne(t){const{__scopeCheckbox:a,checked:s,children:o,defaultChecked:n,disabled:r,form:u,name:l,onCheckedChange:i,required:b,value:h="on",internal_do_not_use_render:c}=t,[p,g]=D({prop:s,defaultProp:n??!1,onChange:i,caller:_}),[d,v]=f.useState(null),[k,m]=f.useState(null),x=f.useRef(!1),C=d?!!u||!!d.closest("form"):!0,w={checked:p,disabled:r,setChecked:g,control:d,setControl:v,name:l,form:u,value:h,hasConsumerStoppedPropagationRef:x,required:b,defaultChecked:j(n)?!1:n,isFormControl:C,bubbleInput:k,setBubbleInput:m};return e.jsx(Ee,{scope:a,...w,children:Re(c)?c(w):o})}var G="CheckboxTrigger",K=f.forwardRef(({__scopeCheckbox:t,onKeyDown:a,onClick:s,...o},n)=>{const{control:r,value:u,disabled:l,checked:i,required:b,setControl:h,setChecked:c,hasConsumerStoppedPropagationRef:p,isFormControl:g,bubbleInput:d}=I(G,t),v=S(n,h),k=f.useRef(i);return f.useEffect(()=>{const m=r?.form;if(m){const x=()=>c(k.current);return m.addEventListener("reset",x),()=>m.removeEventListener("reset",x)}},[r,c]),e.jsx(y.button,{type:"button",role:"checkbox","aria-checked":j(i)?"mixed":i,"aria-required":b,"data-state":J(i),"data-disabled":l?"":void 0,disabled:l,value:u,...o,ref:v,onKeyDown:P(a,m=>{m.key==="Enter"&&m.preventDefault()}),onClick:P(s,m=>{c(x=>j(x)?!0:!x),d&&g&&(p.current=m.isPropagationStopped(),p.current||m.stopPropagation())})})});K.displayName=G;var X=f.forwardRef((t,a)=>{const{__scopeCheckbox:s,name:o,checked:n,defaultChecked:r,required:u,disabled:l,value:i,onCheckedChange:b,form:h,...c}=t;return e.jsx(Ne,{__scopeCheckbox:s,checked:n,defaultChecked:r,disabled:l,required:u,onCheckedChange:b,name:o,form:h,value:i,internal_do_not_use_render:({isFormControl:p})=>e.jsxs(e.Fragment,{children:[e.jsx(K,{...c,ref:a,__scopeCheckbox:s}),p&&e.jsx(Y,{__scopeCheckbox:s})]})})});X.displayName=_;var Z="CheckboxIndicator",W=f.forwardRef((t,a)=>{const{__scopeCheckbox:s,forceMount:o,...n}=t,r=I(Z,s);return e.jsx(ie,{present:o||j(r.checked)||r.checked===!0,children:e.jsx(y.span,{"data-state":J(r.checked),"data-disabled":r.disabled?"":void 0,...n,ref:a,style:{pointerEvents:"none",...t.style}})})});W.displayName=Z;var V="CheckboxBubbleInput",Y=f.forwardRef(({__scopeCheckbox:t,...a},s)=>{const{control:o,hasConsumerStoppedPropagationRef:n,checked:r,defaultChecked:u,required:l,disabled:i,name:b,value:h,form:c,bubbleInput:p,setBubbleInput:g}=I(V,t),d=S(s,g),v=H(r),k=Q(o);f.useEffect(()=>{const x=p;if(!x)return;const C=window.HTMLInputElement.prototype,B=Object.getOwnPropertyDescriptor(C,"checked").set,ne=!n.current;if(v!==r&&B){const oe=new Event("click",{bubbles:ne});x.indeterminate=j(r),B.call(x,j(r)?!1:r),x.dispatchEvent(oe)}},[p,v,r,n]);const m=f.useRef(j(r)?!1:r);return e.jsx(y.input,{type:"checkbox","aria-hidden":!0,defaultChecked:u??m.current,required:l,disabled:i,name:b,value:h,form:c,...a,tabIndex:-1,ref:d,style:{...a.style,...k,position:"absolute",pointerEvents:"none",opacity:0,margin:0,transform:"translateX(-100%)"}})});Y.displayName=V;function Re(t){return typeof t=="function"}function j(t){return t==="indeterminate"}function J(t){return j(t)?"indeterminate":t?"checked":"unchecked"}var E="Switch",[Pe]=M(E),[Fe,qe]=Pe(E),ee=f.forwardRef((t,a)=>{const{__scopeSwitch:s,name:o,checked:n,defaultChecked:r,required:u,disabled:l,value:i="on",onCheckedChange:b,form:h,...c}=t,[p,g]=f.useState(null),d=S(a,C=>g(C)),v=f.useRef(!1),k=p?h||!!p.closest("form"):!0,[m,x]=D({prop:n,defaultProp:r??!1,onChange:b,caller:E});return e.jsxs(Fe,{scope:s,checked:m,disabled:l,children:[e.jsx(y.button,{type:"button",role:"switch","aria-checked":m,"aria-required":u,"data-state":ae(m),"data-disabled":l?"":void 0,disabled:l,value:i,...c,ref:d,onClick:P(t.onClick,C=>{x(w=>!w),k&&(v.current=C.isPropagationStopped(),v.current||C.stopPropagation())})}),k&&e.jsx(re,{control:p,bubbles:!v.current,name:o,value:i,checked:m,required:u,disabled:l,form:h,style:{transform:"translateX(-100%)"}})]})});ee.displayName=E;var te="SwitchThumb",se=f.forwardRef((t,a)=>{const{__scopeSwitch:s,...o}=t,n=qe(te,s);return e.jsx(y.span,{"data-state":ae(n.checked),"data-disabled":n.disabled?"":void 0,...o,ref:a})});se.displayName=te;var ze="SwitchBubbleInput",re=f.forwardRef(({__scopeSwitch:t,control:a,checked:s,bubbles:o=!0,...n},r)=>{const u=f.useRef(null),l=S(u,r),i=H(s),b=Q(a);return f.useEffect(()=>{const h=u.current;if(!h)return;const c=window.HTMLInputElement.prototype,g=Object.getOwnPropertyDescriptor(c,"checked").set;if(i!==s&&g){const d=new Event("click",{bubbles:o});g.call(h,s),h.dispatchEvent(d)}},[i,s,o]),e.jsx("input",{type:"checkbox","aria-hidden":!0,defaultChecked:s,...n,tabIndex:-1,ref:l,style:{...n.style,...b,position:"absolute",pointerEvents:"none",opacity:0,margin:0}})});re.displayName=ze;function ae(t){return t?"checked":"unchecked"}var Ie=ee,Be=se;const Le=t=>ce({queryKey:["quiz-settings",t],queryFn:async()=>(await $.get(`/quizzes/${t}/settings`)).data?.data,enabled:!!t}),Te=t=>{const a=de();return le({mutationKey:["update-quiz-settings",t],mutationFn:async s=>(await $.post(`/quizzes/${t}/settings`,s)).data,onSuccess:()=>{N.success("Settings updated successfully!"),a.invalidateQueries({queryKey:["quiz-settings",t]})},onError:s=>{const o="Failed to update settings.";ue(s)?N.error(s.response?.data?.message||s.message||o):N.error(o)}})};function Ae({className:t,...a}){return e.jsx(X,{"data-slot":"checkbox",className:F("peer flex size-4 shrink-0 items-center justify-center rounded-[4px] border border-input shadow-xs transition-shadow outline-none focus-visible:border-ring focus-visible:ring-[3px] focus-visible:ring-ring/50 disabled:cursor-not-allowed disabled:opacity-50 aria-invalid:border-destructive aria-invalid:ring-destructive/20 data-[state=checked]:border-primary data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground dark:aria-invalid:ring-destructive/40",t),...a,children:e.jsx(W,{"data-slot":"checkbox-indicator",className:"grid place-content-center text-current",children:a.checked==="indeterminate"?e.jsx("svg",{width:"9",height:"9",viewBox:"0 0 9 9",fill:"currentcolor",xmlns:"http://www.w3.org/2000/svg",children:e.jsx("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M0.75 4.5C0.75 4.08579 1.08579 3.75 1.5 3.75H7.5C7.91421 3.75 8.25 4.08579 8.25 4.5C8.25 4.91421 7.91421 5.25 7.5 5.25H1.5C1.08579 5.25 0.75 4.91421 0.75 4.5Z"})}):e.jsx("svg",{width:"9",height:"9",viewBox:"0 0 9 9",fill:"currentcolor",xmlns:"http://www.w3.org/2000/svg",children:e.jsx("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M8.53547 0.62293C8.88226 0.849446 8.97976 1.3142 8.75325 1.66099L4.5083 8.1599C4.38833 8.34356 4.19397 8.4655 3.9764 8.49358C3.75883 8.52167 3.53987 8.45309 3.3772 8.30591L0.616113 5.80777C0.308959 5.52987 0.285246 5.05559 0.563148 4.74844C0.84105 4.44128 1.31533 4.41757 1.62249 4.69547L3.73256 6.60459L7.49741 0.840706C7.72393 0.493916 8.18868 0.396414 8.53547 0.62293Z"})})})})}const A=({name:t,control:a,label:s="",description:o="",disabled:n=!1})=>e.jsx(U,{control:a,name:t,render:({field:r,fieldState:u})=>{const{value:l,onChange:i,onBlur:b,name:h}=r,{invalid:c,error:p}=u;return e.jsxs(O,{"data-invalid":c,orientation:"horizontal",className:"w-fit",children:[e.jsx(Ae,{id:h,checked:l,onCheckedChange:i,onBlur:b,"aria-invalid":c,disabled:n}),e.jsxs(q,{children:[!!s&&e.jsx(ke,{htmlFor:h,className:"cursor-pointer whitespace-nowrap",children:s}),!!o&&!c&&e.jsx(Ce,{children:o}),c&&e.jsx(z,{errors:[p]})]})]})}});function Me({className:t,...a}){return e.jsx(Ie,{"data-slot":"switch",className:F("peer data-[state=checked]:bg-primary data-[state=unchecked]:bg-input focus-visible:border-ring focus-visible:ring-ring/50 dark:data-[state=unchecked]:bg-input/80 inline-flex h-[1.15rem] w-8 shrink-0 items-center rounded-full border border-transparent shadow-xs transition-all outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50",t),...a,children:e.jsx(Be,{"data-slot":"switch-thumb",className:F("bg-background dark:data-[state=unchecked]:bg-foreground dark:data-[state=checked]:bg-primary-foreground pointer-events-none block size-4 rounded-full ring-0 transition-transform data-[state=checked]:translate-x-[calc(100%-2px)] data-[state=unchecked]:translate-x-0")})})}const De=({name:t,control:a,disabled:s=!1})=>e.jsx(U,{control:a,name:t,render:({field:o,fieldState:n})=>{const{value:r,onChange:u,name:l}=o,{invalid:i}=n;return e.jsx(O,{"data-invalid":i,orientation:"horizontal",className:"w-fit",children:e.jsx(Me,{id:l,checked:r,onCheckedChange:u,disabled:s,"aria-invalid":i})})}}),He={quiz_id:void 0,lead_form:{email:{enabled:!1,required:!1},phone:{enabled:!1,required:!1},address:{enabled:!1,required:!1},zip:{enabled:!1,required:!1}},result_delivery:{email:!1,pdf:!1,link:!1}};function Xe(){const{id:t}=he.useParams(),a=pe(),s=[{name:"email",label:"Email"},{name:"phone",label:"Phone"},{name:"address",label:"Address"},{name:"zip",label:"Zip Code"}],o=[{name:"email",label:"Email"},{name:"pdf",label:"PDF"},{name:"link",label:"Link"}],{data:n,isLoading:r}=fe(Le(t)),{mutate:u,isPending:l}=Te(t),i=je({resolver:we(me),defaultValues:n||He}),{control:b,handleSubmit:h,formState:{errors:c},reset:p}=i;console.log("ðŸ‘‰ ~ QuizSettingsPage ~ errors:",c);const g=d=>{u(d,{onSuccess:()=>{a({to:"/",search:{page:1,per_page:15}})}})};return f.useEffect(()=>{n&&p(n)},[n,p]),e.jsxs("div",{className:"flex-1 flex flex-col gap-6 overflow-hidden",children:[e.jsx(xe,{className:"flex items-start gap-2",children:e.jsx(Se,{title:"Quiz Settings",description:"Configure lead generation and result delivery for this quiz."})}),r?e.jsx("div",{className:"flex items-center justify-center p-12",children:e.jsx("p",{className:"text-muted-foreground",children:"Loading settings..."})}):e.jsxs(ge,{className:"flex-1 flex flex-col overflow-hidden",children:[e.jsx("form",{onSubmit:h(g),className:"space-y-8 flex-1 overflow-y-auto",children:e.jsxs(R,{children:[e.jsxs(L,{children:[e.jsxs(q,{children:[e.jsx(T,{children:"Lead Form"}),e.jsx(z,{errors:[c.lead_form]})]}),e.jsx(R,{"data-slot":"checkbox-group",children:s.map(d=>e.jsxs("div",{className:"flex items-center gap-2 justify-between max-w-xs",children:[e.jsx(A,{control:b,name:`lead_form.${d.name}.enabled`,label:d.label}),e.jsx(De,{control:b,name:`lead_form.${d.name}.required`,label:"Required"})]},d.name))})]}),e.jsx(ye,{}),e.jsxs(L,{children:[e.jsxs(q,{children:[e.jsx(T,{children:"Result Delivery"}),e.jsx(z,{errors:[c.result_delivery]})]}),e.jsx(R,{"data-slot":"checkbox-group",children:o.map(d=>e.jsx("div",{children:e.jsx(A,{control:b,name:`result_delivery.${d.name}`,label:d.label})},d.name))})]})]})}),e.jsx(ve,{className:"pt-4 w-full flex justify-end items-center gap-2",children:e.jsx(be,{type:"button",className:"min-w-36",onClick:h(g),loading:l,children:"Save Settings"})})]})]})}export{Xe as component};
