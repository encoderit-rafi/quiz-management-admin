import{aD as g,j as e,B as h,ae as N,ah as y}from"./index-C0O9Q7MJ.js";import{u as S,a as w,j as C}from"./field-wCSYO7Ng.js";import{F as b}from"./form-input-BTBxnoh2.js";import"./password-input-BRREzLrV.js";import"./context-CBWJO7S0.js";import{c as D,d as F}from"./card-DH7LzJZY.js";import{D as z,b as Q,S as q,v as I,u as E,C as O}from"./sortable.esm-CvjGp21f.js";import{G as A}from"./grip-vertical-DHgGwv_s.js";function R({id:i,index:r,control:l,onRemove:a}){const{attributes:m,listeners:o,setNodeRef:c,transform:d,transition:u,isDragging:p}=E({id:i}),x={transition:u,transform:O.Transform.toString(d),opacity:p?.5:1};return e.jsxs("div",{ref:c,style:x,className:"flex gap-2 items-start",children:[e.jsx("button",{type:"button",className:"cursor-grab active:cursor-grabbing touch-none p-1 hover:bg-muted rounded mt-1",...m,...o,children:e.jsx(A,{className:"h-4 w-4 text-muted-foreground"})}),e.jsx("div",{className:"flex-1",children:e.jsx(b,{name:`options.${r}.label`,control:l,placeholder:"Option label"})}),e.jsx("div",{className:"w-24",children:e.jsx(b,{name:`options.${r}.points`,control:l,type:"number",placeholder:"Pts"})}),e.jsx(h,{type:"button",variant:"ghost",size:"icon",className:"mt-1 text-destructive hover:text-destructive hover:bg-destructive/10",onClick:a,children:e.jsx(y,{className:"h-4 w-4"})})]})}function U({type:i,id:r}){console.log("ðŸ‘‰ ~ FormQuizQuestion ~ type, id:",i,r);const l=S({resolver:w(g),defaultValues:{name:"",options:[{label:"",points:0}]}}),{control:a,handleSubmit:m}=l,{fields:o,append:c,remove:d,move:u}=C({control:a,name:"options"}),p=s=>{const{active:t,over:n}=s;if(!n||t.id===n.id)return;const j=o.findIndex(f=>f.id===t.id),v=o.findIndex(f=>f.id===n.id);u(j,v)},x=s=>{const t={...s,options:s.options.map(n=>({...n,points:Number(n.points)}))};console.log("ðŸ‘‰ ~ onSubmit ~ processedData:",t)};return e.jsxs(D,{className:"flex-1 flex flex-col overflow-hidden",children:[e.jsxs("form",{id:"quiz-question-form",onSubmit:m(x),className:"space-y-6 flex-1 overflow-y-auto p-1 pr-4",children:[e.jsx(b,{name:"name",control:a,label:"Question Name",placeholder:"Enter question"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("label",{className:"text-sm font-medium",children:"Options"}),e.jsxs(h,{type:"button",variant:"outline",size:"sm",onClick:()=>c({label:"",points:0}),children:[e.jsx(N,{className:"h-3 w-3 mr-1"})," Add Option"]})]}),e.jsx("div",{className:"space-y-2 max-h-[300px] overflow-y-auto pr-2",children:e.jsx(z,{onDragEnd:p,collisionDetection:Q,children:e.jsx(q,{items:o,strategy:I,children:o.map((s,t)=>e.jsx(R,{id:s.id,index:t,control:a,onRemove:()=>d(t)},s.id))})})})]})]}),e.jsx(F,{className:"pt-4 w-full flex justify-end items-center gap-2",children:e.jsx(h,{type:"submit",className:"min-w-36",form:"quiz-question-form",children:i==="update"?"Update":"Create"})})]})}export{U as F};
