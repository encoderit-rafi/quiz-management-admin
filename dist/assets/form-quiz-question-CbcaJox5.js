import{aL as v,j as e,B as h,an as N,aq as y}from"./index-CDJ7DgKs.js";import{u as S,a as w,j as C}from"./field-B7Wg_fYW.js";import{F}from"./form-image-upload-CeIFgKT8.js";import{F as b}from"./form-input-BDk7ste-.js";import"./password-input-DfsXY_sW.js";import"./context-DX6TRtil.js";import{b as q,c as D}from"./card-DinPMtRP.js";import{D as Q,b as z,S as I,v as E,u as O,C as A}from"./sortable.esm-JhQovfaO.js";import{G as R}from"./grip-vertical-Bxul20st.js";function U({id:n,index:r,control:l,onRemove:o}){const{attributes:m,listeners:a,setNodeRef:c,transform:d,transition:u,isDragging:p}=O({id:n}),x={transition:u,transform:A.Transform.toString(d),opacity:p?.5:1};return e.jsxs("div",{ref:c,style:x,className:"flex gap-2 items-start",children:[e.jsx("button",{type:"button",className:"cursor-grab active:cursor-grabbing touch-none p-1 hover:bg-muted rounded mt-1",...m,...a,children:e.jsx(R,{className:"h-4 w-4 text-muted-foreground"})}),e.jsx("div",{className:"flex-1",children:e.jsx(b,{name:`options.${r}.label`,control:l,placeholder:"Option label"})}),e.jsx("div",{className:"w-24",children:e.jsx(b,{name:`options.${r}.points`,control:l,type:"number",placeholder:"Pts"})}),e.jsx(h,{type:"button",variant:"ghost",size:"icon",className:"mt-1 text-destructive hover:text-destructive hover:bg-destructive/10",onClick:o,children:e.jsx(y,{className:"h-4 w-4"})})]})}function H({type:n,id:r}){console.log("ðŸ‘‰ ~ FormQuizQuestion ~ type, id:",n,r);const l=S({resolver:w(v),defaultValues:{name:"",question_image:null,options:[{label:"",points:0}]}}),{control:o,handleSubmit:m}=l,{fields:a,append:c,remove:d,move:u}=C({control:o,name:"options"}),p=s=>{const{active:t,over:i}=s;if(!i||t.id===i.id)return;const g=a.findIndex(f=>f.id===t.id),j=a.findIndex(f=>f.id===i.id);u(g,j)},x=s=>{const t={...s,options:s.options.map(i=>({...i,points:Number(i.points)}))};console.log("ðŸ‘‰ ~ onSubmit ~ processedData:",t)};return e.jsxs(q,{className:"flex-1 flex flex-col overflow-hidden",children:[e.jsxs("form",{id:"quiz-question-form",onSubmit:m(x),className:"space-y-6 flex-1 overflow-y-auto p-1 pr-4",children:[e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:e.jsx(F,{name:"question_image",control:o,label:"Question Image",description:"Upload or drag a question image"})}),e.jsx(b,{name:"name",control:o,label:"Question Name",placeholder:"Enter question"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("label",{className:"text-sm font-medium",children:"Options"}),e.jsxs(h,{type:"button",variant:"outline",size:"sm",onClick:()=>c({label:"",points:0}),children:[e.jsx(N,{className:"h-3 w-3 mr-1"})," Add Option"]})]}),e.jsx("div",{className:"space-y-2 max-h-[300px] overflow-y-auto pr-2",children:e.jsx(Q,{onDragEnd:p,collisionDetection:z,children:e.jsx(I,{items:a,strategy:E,children:a.map((s,t)=>e.jsx(U,{id:s.id,index:t,control:o,onRemove:()=>d(t)},s.id))})})})]})]}),e.jsx(D,{className:"pt-4 w-full flex justify-end items-center gap-2",children:e.jsx(h,{type:"submit",className:"min-w-36",form:"quiz-question-form",children:n==="update"?"Update":"Create"})})]})}export{H as F};
